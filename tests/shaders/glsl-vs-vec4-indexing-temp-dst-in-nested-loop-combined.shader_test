[require]
GLSL >= 1.10

[vertex shader]
uniform float one;
uniform int count1, count2;
uniform vec4 red;

void main()
{
    vec4 array[11];
    array[0] = vec4(0.1, 0,   0,   0) * one;
    array[1] = vec4(0,   0.1, 0,   0) * one;
    array[2] = vec4(0,   0,   0.1, 0) * one;
    array[3] = vec4(0,   0.1, 0,   0) * one;
    array[4] = vec4(0,   0  , 0.1, 0) * one;
    array[5] = vec4(0,   0,   0.1, 0) * one;
    array[6] = vec4(0.1, 0,   0,   0) * one;
    array[7] = vec4(0,   0.1, 0,   0) * one;
    array[8] = vec4(0,   0.1, 0.1, 0) * one;
    array[9] = vec4(0.1, 0.1, 0,   0) * one;
    array[10] = vec4(0.1, 0,   0.1, 0) * one;
    gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;
    for (int i = 0; i < count1; i++)
        for (int j = 0; j < count2; j++)
            array[i*3+j] += red*float(j+1);
    gl_FrontColor = array[0] + array[1] + array[2] + array[3] + array[4] +
         array[5] + array[6] + array[7] + array[8] + array[9] + array[10];
}

[fragment shader]
void main()
{
	gl_FragColor = gl_Color;
}

[test]
ortho
clear color 0.25 0.25 0.25 0.25
clear
uniform float one 1
uniform vec4 red 0.025 0 0 0

uniform int count1 0
uniform int count2 0
draw rect 10 10 10 10
probe rgb 15 15 0.4 0.5 0.5

uniform int count1 1
uniform int count2 1
draw rect 30 10 10 10
probe rgb 35 15 0.425 0.5 0.5

uniform int count1 3
uniform int count2 1
draw rect 50 10 10 10
probe rgb 55 15 0.475 0.5 0.5

uniform int count1 1
uniform int count2 3
draw rect 70 10 10 10
probe rgb 75 15 0.55 0.5 0.5

uniform int count1 2
uniform int count2 3
draw rect 90 10 10 10
probe rgb 95 15 0.7 0.5 0.5

uniform int count1 2
uniform int count2 4
draw rect 110 10 10 10
probe rgb 115 15 0.9 0.5 0.5

uniform int count1 2
uniform int count2 5
draw rect 130 10 10 10
probe rgb 135 15 1.0 0.5 0.5

uniform int count1 1
uniform int count2 6
draw rect 150 10 10 10
probe rgb 155 15 0.925 0.5 0.5

uniform int count1 4
uniform int count2 1
draw rect 170 10 10 10
probe rgb 175 15 0.5 0.5 0.5

uniform int count1 4
uniform int count2 2
draw rect 190 10 10 10
probe rgb 195 15 0.7 0.5 0.5

uniform int count1 3
uniform int count2 5
draw rect 210 10 10 10
probe rgb 215 15 1.0 0.5 0.5

